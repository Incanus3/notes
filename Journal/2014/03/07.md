=== Fri, 7.3. ===

- prace - alto
  - 11-1
    - created jointable for client companies
      added migration
      added ClientCompany model (bt client & company, wrap type, scopes)
      reannotated models
      ModelExtensions.wrap_attribute doesn't hide the accessors if the original
        new names are the same
    - disabled specs for client's companies management
    - created subclasses of ClientCompany for both company types
  - 1.15-1.45
    - added company relations to Client model
    - added validations to ClientCompany
  - 1.45-2.45
    - removed single relationships between client and companies
      removed Client belongs_to :chain and :canteen
      removed validations of company associations
      removed validations of client_id and card_id with respect to canteen and
      removed Company has_many :consumers
      removed :jidelna_firma_key and :retezec_firma_key columns from client
      updated Client spec and factories
    - updated ClientsController
      clients_grid includes relationships instead of single companies
      Client::Create and Update no longer sets canteen and chain
      removed set_companies from Client
      removed canteen and chain from client index, show and new/edit form
      updated spec
  - 3-3.45
    - Employer raises Employer::NotFound
      Client::Create and Update rescue this
    - fixed specs
      models/company
      features/create_user_with_client
      services/client/create and update
    - added client_relations to Canteen
      Canteen has_many client_relations
      Canteen has_many consumers through client_relations
    - fixed login by card spec by creating relationship btw client and company
      correctly
    - set inheritance_column to none in Company and ClientCompany, otherwise we g
      error when setting type in mass assignment
    - renamed jidelak.jidelna_firma_key to firma_key
  - 4-4.30
    - added canteens and chains to client through relations
      ClientAuth#current_canteen now returns first canteen of current_client
    - fixed MenusController spec, consumption spec - create relationships
    - updated shared contexts for login - create proper relationships
    - added factories for ClientCanteen and ClientChain
  - 5.30-6.45
    - added administration of client-company relations
      admin can add/remove client to/from canteen/chain on client's edit page
      added routes - clients/add_canteen, add_chain, remove_relation
      added ClientRelationsController with appropriate actions
      added lists of current canteens and chains with delete buttons
      added forms for adding canteens and chains
      ClientsController#edit sets @canteens and @chains to companies not already
        in a relation with client
      added feature specs
    - moved except_ids scope from Chain to Company
    - fixed clients controller spec
    - added list of canteens and chains to client's show page
    - updated info page
  = 6h

- client no longer validates uniqueness of client_id and card_id wrt canteen and
  chain as it no longer belongs to single canteen and chain
- client must validate, that it has at least one canteen or chain relationship
  manually, also when it has single relationships it must have employer

- specs to fix:
  - menu
  - MenusController
  - consumption history

- SessionsController#user - should be found using relation, not email
- log in by card now only works if client has relationship with canteen, doesn't
  work with chain
