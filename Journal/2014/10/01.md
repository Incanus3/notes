=== Wed, 1.10. ===

== Postgres window functions ==
http://robots.thoughtbot.com/postgres-window-functions
http://www.postgresql.org/docs/9.3/static/tutorial-window.html
http://www.postgresql.org/docs/9.3/static/functions-window.html
http://robots.thoughtbot.com/active-record-eager-loading-with-query-objects-and-decorators

alto=# select * from (select *,row_number() OVER (PARTITION BY s_o_v ORDER BY jidelna_key) from jidelak) AS ranked;
- kazdy radek ma ruzne row_number v ramci partisny podle s_o_v, serazene podle
  jidelna_key - i radky se stejnou jidelnou

 id  | jidelna_key |   datum    | s_o_v | cislo_jidla | c_karty_jidla |              nazev_jidla              | row_number
  27 |           1 | 2014-08-25 | O     | 1           |            26 | Accusantium sit quam.                 |         27
  28 |           1 | 2014-08-25 | O     | 2           |            27 | Alias rerum minima et.                |         28
  70 |           1 | 2014-09-01 | O     | 2           |            69 | Quo molestiae ex omnis.               |         29
  69 |           1 | 2014-09-01 | O     | 1           |            68 | Cumque delectus et.                   |         30
 154 |           2 | 2014-08-31 | O     | 2           |           153 | Qui iusto nesciunt reprehenderit.     |         31
 123 |           2 | 2014-08-26 | O     | 1           |           122 | In facilis quibusdam rem.             |         32
 124 |           2 | 2014-08-26 | O     | 2           |           123 | Hic nobis iure doloremque.            |         33
 153 |           2 | 2014-08-31 | O     | 1           |           152 | Similique itaque corporis reiciendis. |         34

alto=# select * from (select *,rank() OVER (PARTITION BY s_o_v ORDER BY jidelna_key) from jidelak) AS ranked;
- kazda skupina se stejnou jidelnou (v ramci partisny) ma stejny rank podle
  row_number prvniho radku ze skupiny (v cislech jsou diry)

 id  | jidelna_key |   datum    | s_o_v | cislo_jidla | c_karty_jidla |              nazev_jidla              | rank
-----+-------------+------------+-------+-------------+---------------+---------------------------------------+------
  27 |           1 | 2014-08-25 | O     | 1           |            26 | Accusantium sit quam.                 |    1
  28 |           1 | 2014-08-25 | O     | 2           |            27 | Alias rerum minima et.                |    1
  70 |           1 | 2014-09-01 | O     | 2           |            69 | Quo molestiae ex omnis.               |    1
  69 |           1 | 2014-09-01 | O     | 1           |            68 | Cumque delectus et.                   |    1
 154 |           2 | 2014-08-31 | O     | 2           |           153 | Qui iusto nesciunt reprehenderit.     |   31
 123 |           2 | 2014-08-26 | O     | 1           |           122 | In facilis quibusdam rem.             |   31
 124 |           2 | 2014-08-26 | O     | 2           |           123 | Hic nobis iure doloremque.            |   31
 153 |           2 | 2014-08-31 | O     | 1           |           152 | Similique itaque corporis reiciendis. |   31

alto=# select * from (select *,dense_rank() OVER (PARTITION BY s_o_v ORDER BY jidelna_key) from jidelak) AS ranked;
- kazda skupina se stejnou jidelnou (v ramci partisny) ma stejny dense_rank
  podle poradi skupiny (v cislech nejsou diry)

 id  | jidelna_key |   datum    | s_o_v | cislo_jidla | c_karty_jidla |              nazev_jidla              | dense_rank
  27 |           1 | 2014-08-25 | O     | 1           |            26 | Accusantium sit quam.                 |          1
  28 |           1 | 2014-08-25 | O     | 2           |            27 | Alias rerum minima et.                |          1
  70 |           1 | 2014-09-01 | O     | 2           |            69 | Quo molestiae ex omnis.               |          1
  69 |           1 | 2014-09-01 | O     | 1           |            68 | Cumque delectus et.                   |          1
 154 |           2 | 2014-08-31 | O     | 2           |           153 | Qui iusto nesciunt reprehenderit.     |          2
 123 |           2 | 2014-08-26 | O     | 1           |           122 | In facilis quibusdam rem.             |          2
 124 |           2 | 2014-08-26 | O     | 2           |           123 | Hic nobis iure doloremque.            |          2
 153 |           2 | 2014-08-31 | O     | 1           |           152 | Similique itaque corporis reiciendis. |          2
