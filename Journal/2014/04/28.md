=== Mon, 28.4. ===

- prace - alto
  - 6-10.15
    - rozmysleni poslednich detailu ukladani jidelny v databazi

    tested checking of relation existence in Orders::SinglePortionController
    simplified Orders::MultiplePortionController spec
    - needs to be simplified even more to test checking of relation existence
    - added notes for this
    added notes for checking existence of client-canteen relation in ordering
      controllers

    simplified Orders::MultiplePortionController spec

    extracted functionality shared by SinglePortionController and
      MultiplePortionController (Terminal, ordered_from, check_relation_exists)
      into OrdersController (their new parent)
    MultiplePortionController no longer handles OrderNotFound
    - this shouldn't happen and if it does, it's MenusController's fault
    SinglePortionController no longer handles NotYourOrderException
    - this should be prevented by CSFR protection
    added ClientController which checks that current_user is a client (not
      admin)
    - used as parent of ConsumptionsController, CurrentCanteenController,
      MenusController, OrdersController
    updated specs

    renamed singleton resources (menu, consumption, wellcome) from plural to
      singular

    tested that ordered_from is passed to
      order.increase and .decrease by Orders::MultiplePortionsController

  - 11.45-12.15
    - projiti kodu, sepsani dotcenych casti, poznamky ke zmenam

  - 12.30-3.30
    ClientCanteenRelation now stores ids of the
      relations - (client-canteen or (client-chain and chain-canteen))
    - updated ClientCanteenRelation, RelationPresenter
    selected relation is now stored in User, instead of cookies
    - added migration
    - updated User, StoredRelation, CurrentCanteenController
    - clearing of stored relation after login is no longer needed
      - updated SessionsController
    - renamed CanteenChain to ChainCanteen
      - updated Chain, Canteen
    updated specs
