=== Wed, 18.6. ===

- prace - alto
  - 11.45-12.45, 4-4.15, 5.45-6.15, 6.30-7.15
    reseni datastore s evzou

    updated gems
    updated RSpec to 3.0.1
    - added rspec-activemodel-mocks and rspec-collection_matchers
    - extracted rails_helper and simplecov_helper from spec_helper
    - required rails_helper instead of spec_helper (which is required in .rspec)
    - changed stubs, be_true/be_false to new syntax
    - added record.reload where needed)

  - 8-8.30 - začátek upgrade na bootstrap 3
  - 10-10.15,10.45-11.15,12.15-12.30 - úprava navbaru

  = 4h

=== Rails ===
== building RESTful HTTP APIs ==
http://devblog.reverb.com/post/47197560134/hal-siren-rabl-roar-garner-building-hypermedia

== listening for callbacks ==
https://github.com/krisleech/wisper

class Bid < ActiveRecord::Base
  include Wisper::Publisher

  validates :amount, :presence => true

  def commit(_attrs = nil)
    assign_attributes(_attrs) if _attrs.present?
    if valid?
      save!
      publish(:create_bid_successful, self)
    else
      publish(:create_bid_failed, self)
    end
  end
end

class BidsController < ApplicationController
  def new
    @bid = Bid.new
  end

  def create
    @bid = Bid.new(params[:bid])

    @bid.subscribe(PusherListener.new)
    @bid.subscribe(ActivityListener.new)
    @bid.subscribe(StatisticsListener.new)

    @bid.on(:create_bid_successful) { |bid| redirect_to bid }
    @bid.on(:create_bid_failed)     { |bid| render :action => :new }

    @bid.commit
  end
end
