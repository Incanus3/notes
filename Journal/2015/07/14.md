=== Tue, 14.7. ===

- 10.45-11.15 - hajek - zjistovani zustatku
  - vypnuti validace CSRF tokenu v BalanceControlleru

- 11.15-12.45 - rezervace - bg job pro uzavirani plateb
  - zacatek testovani uzavreni prerusene platby
    - filtrovani sql logu

- 4.30-6.30
  - filtrovani sql logu

- 6.30-9
  - testovani automatickeho uzavreni objednavky v dalsich stavech
    tested order cancelling by unfinished order closer when cancelled by customer

    updated unfinished order closer - finishes unfinished payment reversal
    - payment reversal is now two-phase
      - added payment_reversal_initiated Order state
      - PaymentsController initiates reversal before talking to payment gateway (in case response is
        lost)
      - added unfinished Order scope - includes payment_initialized and payment_reversal_initated states
    - closer checks all unfinished orders
    - tested

    tried to test background closing of rejected payment
    - payment stays in in_process state until timeout - can't be tested

- 10.30-11
  added dry-run support to unfinished order closer
  - only one check is performed on dry-run - no scheduling since it would repeat all checks
  refactored
  - encapsulated in UnfinishedOrderCloser class
  - no need to pass logger and dry-run flag around
  - delegated logger calls

  added monogid config example

- 11.45-1.45 - deployment
  - snaha o nasazeni na testovaci server
  - segfaultuje puma
  - na testingu vraci pozadavek 400 Bad Request (vypada na spatny podpis)
  - na productionu nelze naopak verifikovat odpoved

= 9h
