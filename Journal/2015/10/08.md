=== Thu, 8.10. ===

- 3-1am - studium dockeru
  created basic alto-dev image
  - installs basic tools - db client, editor, git, ruby, python
  - sets up configuration - bash, vim, ssh
  - adds alto gitlab to known hosts, adds deploy key
  - enables passwordless sudo

  created datastore-food image
  - clones ds-food from gitlab
  - installs dependencies
  - adds database.yml
  - runs migrations
  - starts server

  added scripts to build and run images and containers

  - extrace ds-common migraci do subrepa, pridani slozky do migration paths v ds-food a
    ds-rezervace, uprava tak, aby navazovaly

= 10h

[ ] pripojit migrace ds-common jako subrepo do ds-food a ds-rezervace
[ ] prinutit alembic, aby je poustel z obou zdroju - pouzit alembic branching
[ ] ve starem ruby datastore je skript pro aplikaci migraci (mimo rails) a rake tasky pro plnou
    praci s nimi - prenest do subrepa s migracemi a includovat do datastore
- subrepa s migracemi budou tri - ds-common, rezervace a objednavky
  - rezervace a objednavky budou oboje potrebovat migracni rake tasky - idealne tedy oddelit do
    extra subrepa (prip. oddeleneho repa, ktere je prida do globalni cesty pro rake tasky)

- pro spusteni environmentu s railsy stejne ale potrebuju railsovy konteiner, neni tedy jednodussi
  mit jen environmenty pro rezervace a objednavky a nastartovat nejdriv rails conteiner, ktery
  aplikuje sve migrace jako prvni? v tu chvili nelze ds conteiner pouzit samostatne, ale je to
  takovy problem, aby stalo za to rozbihat migrace z python repozitaru a conteineru?

- ds-food migrace zavisi na railsovych migracich, container objednavkek ale nelze spustit pred
  ds-food, nebot se na nej musi linkovat
- jeden z containeru tedy bude muset spustit oboje migrace
- ktery ze smeru dava vetsi smysl?

- ds-food na railsovych migracich skutecne zavisi
  - i pri samostatnem spusteni (bez rails frontendu) by melo jit manipulovat s railsovymi tabulkami
  - rails tabulky se ds-food tykaji
- rezervace na druhou stranu poskytuji vetsinu funkcnosti bez nutnosti pristupu k datastore
  - navic ds tabulky jsou od railsovych naprosto odlisne - railsy by o nich nemely vedet

-> ds-food by mel byt schopen spustit railsove migrace

- pak dodelat rails conteiner a pospojovat je dohromady
- pak teprve uvazovat o nezavislosti ds konteineru na railsovych

(python-ds)jakub@incanus:~/.../alto/python/datastore_food 2.2.1@rezervace (master) > alembic history
1a331624bfe -> 3e62fe57733 (df-common) (head), change transaction columns to decimal
31074aa28de -> 18726a2c855 (df-food) (head), add canteen id to transactions
1a331624bfe -> 31074aa28de (df-food), add order and order_item references to sk tables
41c6b684f40 -> 1a331624bfe (branchpoint), create transactions table
8d505c94ba -> 41c6b684f40, create clients table
51749a7b806 -> 8d505c94ba, rename sk tables
10f3faaf02b -> 51749a7b806, create locks table
26baa7a23ab -> 10f3faaf02b, create sk_plt table
cac47d2b4e -> 26baa7a23ab, create sk_pol table
543184c2e26 -> cac47d2b4e, create sk_fin table
47aa56a817f -> 543184c2e26, create sk_sez table
<base> -> 47aa56a817f, create sequences table

(python-ds)jakub@incanus:~/.../alto/python/datastore_food 2.2.1@rezervace (master) > alembic current
18726a2c855 (head)
3e62fe57733 (head)
