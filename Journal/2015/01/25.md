=== Sun, 25.1. ===

- prace - email-machine

== XML schemas ==

// schema file
<?xml version="1.0"?>

           // elements and data types USED IN THE SCHEMA come from this
           // namespace and should be prefixed with xs
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           // elements DEFINED BY THIS SCHEMA (note, to, from, heading, body)
           // come from this namespace
           targetNamespace="http://www.w3schools.com"
           xmlns="http://www.w3schools.com" //default namespace
           // any elements used by the XML instance document which were declared
           // in this schema must be namespace qualified
           elementFormDefault="qualified">
..
..

// data file
<?xml version="1.0"?>
      // default namespace declaration
      // tells the schema-validator that all the elements used in this XML
      // document are declared in the "http://www.w3schools.com" namespace
<note xmlns="http://www.w3schools.com"
      // XML Schema Instance namespace
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      //                  namespace to be used,    location of the schema
      xsi:schemaLocation="http://www.w3schools.com note.xsd">

<to>Tove</to>
<from>Jani</from>
<heading>Reminder</heading>
<body>Don't forget me this weekend!</body>
</note>


</xs:schema>
  // ELEMENTS
  // built-in types: xs:string, decimal, integer, boolean, date, time
  <xs:element name="xxx" type="yyy"/>

  // automatically assigned to the element when no other value is specified
  <xs:element name="color" type="xs:string" default="red"/>

  // automatically assigned to the element, you cannot specify another value
  <xs:element name="color" type="xs:string" fixed="red"/>

  // ATTRIBUTES
  <xs:element name="firstname" type="xs:string">
    // define lang attribute for firstname element
    // can use same datatypes, can provide default or fixed values
    <xs:attribute name="lang" type="xs:string"/>

    // attributes are optional by default, this one is required
    <xs:attribute name="lang" type="xs:string" use="required"/>
  </xs:element>

  // RESTRICTIONS
  // element with integer restriction
  <xs:element name="age">
    <xs:simpleType>
      <xs:restriction base="xs:integer">
        <xs:minInclusive value="0"/>
        <xs:maxInclusive value="120"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>

  // element with a list of allowed values
  <xs:element name="car">
    <xs:simpleType>
      <xs:restriction base="xs:string">
        <xs:enumeration value="Audi"/>
        <xs:enumeration value="Golf"/>
        <xs:enumeration value="BMW"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>

  // could be also specified like this
  // this way the carType type is reusable, it's not part of the car element
  <xs:element name="car" type="carType"/>

  <xs:simpleType name="carType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="Audi"/>
      <xs:enumeration value="Golf"/>
      <xs:enumeration value="BMW"/>
    </xs:restriction>
  </xs:simpleType>

  // pattern restrictions
  <xs:element name="initials">
    <xs:simpleType>
      <xs:restriction base="xs:string">
        <xs:pattern value="[a-zA-Z][a-zA-Z][a-zA-Z]"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>

  // can be also used for other types
  <xs:element name="prodid">
    <xs:simpleType>
      <xs:restriction base="xs:integer">
        <xs:pattern value="[0-9][0-9][0-9][0-9][0-9]"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>

  // restrictions on whitespace
  <xs:element name="address">
    <xs:simpleType>
      <xs:restriction base="xs:string">
        // don't remove any ws
        <xs:whiteSpace value="preserve"/>
        // replace all ws with spaces
        <xs:whiteSpace value="replace"/>
        // replace all ws with spaces, trim leading and trailing ws, collapse
        // subsequent spaces to one
        <xs:whiteSpace value="collapse"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>

  // length restrictions
  <xs:element name="password">
    <xs:simpleType>
      <xs:restriction base="xs:string">
        <xs:length value="8"/>
or
        <xs:minLength value="5"/>
        <xs:maxLength value="8"/>
      </xs:restriction>
    </xs:simpleType>
  </xs:element>

  // other restrictions
  // enumeration (list of acceptable values)
  // fractionDigits (max number of decimal places)
  // maxExclusive, minExclusive, maxInclusive, minInclusive (numeric bounds)
  // length, maxLength, minLength (length bounds - character or item counts)
  // - are inclusive
  // pattern
  // totalDigits (exact number of digits allowed)
  // whiteSpace

  // COMPLEX ELEMENTS
  <product pid="1345"/> //empty, but has attributes

  // contains other elements
  <employee>
    <firstname>John</firstname>
    <lastname>Smith</lastname>
  </employee>

  // contains both text and attributes
  <food type="dessert">Ice cream</food>

  // contains both text and other elements
  <description>
  It happened on <date lang="norwegian">03.03.99</date> ....
  </description>

  // define type directly
  <xs:element name="employee">
    <xs:complexType>
      <xs:sequence> // child elements must appear in this order
        <xs:element name="firstname" type="xs:string"/>
        <xs:element name="lastname" type="xs:string"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  // or reuse type
  <xs:element name="employee" type="personinfo"/>
  <xs:element name="student" type="personinfo"/>
  <xs:element name="member" type="personinfo"/>

  <xs:complexType name="personinfo">
    <xs:sequence>
      <xs:element name="firstname" type="xs:string"/>
      <xs:element name="lastname" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>

  // complex type extension ~ 'inheritance'
  <xs:element name="employee" type="fullpersoninfo"/>

  <xs:complexType name="personinfo">
    <xs:sequence>
      <xs:element name="firstname" type="xs:string"/>
      <xs:element name="lastname" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="fullpersoninfo">
    <xs:complexContent>
      <xs:extension base="personinfo">
        <xs:sequence>
          <xs:element name="address" type="xs:string"/>
          <xs:element name="city" type="xs:string"/>
          <xs:element name="country" type="xs:string"/>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  // define empty element
  // we must define a type that allows elements in its content, but we do not
  // actually declare any elements
  <xs:element name="product">
    <xs:complexType>
      <xs:complexContent>
        <xs:restriction base="xs:integer">
          <xs:attribute name="prodid" type="xs:positiveInteger"/>
        </xs:restriction>
      </xs:complexContent>
    </xs:complexType>
  </xs:element>

  // or more compactly
  <xs:element name="product">
    <xs:complexType>
      <xs:attribute name="prodid" type="xs:positiveInteger"/>
    </xs:complexType>
  </xs:element>

  // complex text-only element (has attributes)
  <xs:element name="somename">
    <xs:complexType>
      <xs:simpleContent> // <----------
        <xs:extension base="basetype">
          ....
          ....
        </xs:extension>
or
        <xs:restriction base="basetype">
          ....
          ....
        </xs:restriction>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>

  // e.g.
  <xs:element name="shoesize">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:integer">
          <xs:attribute name="country" type="xs:string" />
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>

  // mixed-type content
  <letter>
    Dear Mr.<name>John Smith</name>.
    Your order <orderid>1032</orderid>
    will be shipped on <shipdate>2001-07-13</shipdate>.
  </letter>

  <xs:element name="letter">
    <xs:complexType mixed="true">
      <xs:sequence>
        <xs:element name="name" type="xs:string"/>
        <xs:element name="orderid" type="xs:positiveInteger"/>
        <xs:element name="shipdate" type="xs:date"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  // INDICATORS
  // order:
  // - all - any order, 0 or 1 appearances (can set minOccurs to 1)
  // - choice - only one can occur
  // - sequence - in specified order

  // occurrence:
  // - maxOccurs, minOccurs
  // - default is 1
  // - used as attribute of xs:element
  // - integer or "unbounded"

  // element groups:
  // - must contain all, sequence or choice
  <xs:group name="persongroup">
    <xs:sequence>
      <xs:element name="firstname" type="xs:string"/>
      <xs:element name="lastname" type="xs:string"/>
      <xs:element name="birthday" type="xs:date"/>
    </xs:sequence>
  </xs:group>

  <xs:element name="person" type="personinfo"/>

  <xs:complexType name="personinfo">
    <xs:sequence>
      <xs:group ref="persongroup"/>
      <xs:element name="country" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>

  // attribute groups:
  <xs:attributeGroup name="personattrgroup">
    <xs:attribute name="firstname" type="xs:string"/>
    <xs:attribute name="lastname" type="xs:string"/>
    <xs:attribute name="birthday" type="xs:date"/>
  </xs:attributeGroup>

  <xs:element name="person">
    <xs:complexType>
      <xs:attributeGroup ref="personattrgroup"/>
    </xs:complexType>
  </xs:element>

  // The <any> element
  <xs:element name="person">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="firstname" type="xs:string"/>
        <xs:element name="lastname" type="xs:string"/>
        <xs:any minOccurs="0"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  // The <anyAttribute> element
  <xs:element name="person">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="firstname" type="xs:string"/>
        <xs:element name="lastname" type="xs:string"/>
      </xs:sequence>
      <xs:anyAttribute/>
    </xs:complexType>
  </xs:element>
</xs:schema>
