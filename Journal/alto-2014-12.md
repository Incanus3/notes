=== soucet ===

1 + 2.5 + 5 + 3 + 4 + 0.5 + 3 + 1 + 3.5 + 2 = 25.5

=== Sun, 7.12. ===

- prace - alto
  - 12.30-13.30
    updated dependent options for foreign keys after upgrade to rails 4.2 and
      removal of foreigner gem
    fixed stored relation spec
    - relations need to be deleted prior to company delete since fkeys are in place

    added panels around registration fieldsets
    - not showing address panel for ovocenka

  = 1h

=== Tue, 9.12. ===

- prace - alto
  - 4-6.30
    registration form now keeps values and shows validation errors even if client
      with given card_id wasn't found
    - #build_resource builds new client with given attributes
    - #create calls fix_card_id_error which sets error on :card_id to :not_found if
      card id given but client not found
    - tested
    used expose for registration context
    added Client, User and Order Decorators
    - added ClientDecorator#full_name
    - ClientsHelper#client_link moved to ClientDecorator#link
    - updated views, controllers and specs

    set correct registration field types
    - added type optional parameter to RegistrationContextDecorator#field

  = 2h30

=== Wed, 10.12. ===

- prace - alto
  - 2-7
    nested client attributes are now coerced to correct types
    - fixes reading of birth_date parts in view
    - added virtus gem
    - included Virtus.model into NestedAttributes
      - .attributes no longer needed
    - specified attribute types for Client::Personal and Address
    multiparam nested client attributes are now squashed before writing
    - fixes setting of Client::Personal#birth_date=
    - added DatesHelper#squash_multiparam(hash)
      - squashes all multiparam attributes into one date attribute
    - ObjectSerialization#attr= calls squash_mutliparam before passing hash to
      object constructor
    simplified RegistrationsController#build_resource
    - extracted client_attributes
    split registration_spec - extracted conditional_fields_spec

    simplified after_initialize in Client
    hid validation alert in registration form
    updated info page

    updated ruby version in production deploy
    fixed info page

    - debata s evzou, nasazovani na server

    only first part of subdomain (before first dot) is considered for contextual
      registration

    password is now required only for bakare

    updated client editation
    - birth_date is not required and is show as date select

    initializers aren't printed in production

    permitted all personal attributes in Admin::ClientsController and
      RegistrationController
    updated client administration form
    - added missing fields
    - labels no longer needed - added to locales
    updated client show form
    - added missing fields
    updated db/migrate subrepo
    reannotated models

    - snaha o implementaci moznosti opakovane registrace uzivatele s existujicim
      emailem, pokud nebyl potvrzen
      - podminena validace emailu
      - smazani existujiciho usera
      - nechce prihlasit po uspesne registraci

  = 5h

=== Thu, 11.12. ===

- prace - alto
  - 12.15-1.15
    - doreseni smazani existujiciho nepotvrzeneho uzivatele pri registraci
      noveho se stejnym mailem

  - 3.30-4.30
    updated User validation
    - disabled validatable module
    - added custom validations for email and password
      - email is validated for uniqueness only when existing user with email is
        confirmed
      - password is validated for presence only for bakare
    - before saving user, it checks whether unconfirmed user with same email exists
      and deletes him if so
    - tested both User model and registration feature
    fixed specs
    added panels to client administration form

    Client firstname, surname and email is no longer required when creating in
      administration (email is required if user is to be created)
    - added context to presence validation
    - allowed blank email in format validation
    - RegistrationContext#validation_context returns either :registration or
      :bakare, never nil (which would use :create validation context)

    - nasazeni na server, email Lucce

  - 5.30-6.30
    simplified clients#show view
    - added employer_link, sex, news, birth_date, expiration_date,
      canteen_relations, chain_relations to ClientDecorator
    - it also delegates all personal and address readers
    - ClientsHelper and EmployersHelper no longer needed
    - updated show and index views
    client sex is now set using select box and validated
    - added Client::Personal::SEXES and inclusion validation
    - added translations
    - added SexDecorator with .translate and .select_collection
    - RegistrationContextDecorator#field now passes all options to builder.input
    - added colletion option to sex field in registration and client administration
      forms

  = 3h

=== Fri, 12.12. ===

- prace - alto
  - 2.15-6.15
    got rid of CanteensHelper and TranslationHelper
    - added decorators for Canteen, Canteens, Meal, Menu, CourseMenu
    - decorated meal, canteens and menu in meals, terminals and menu controllers
    - views no longer need to call CoursePresenter.translate_course(_plural)
      directly
    - fixed specs

    got rid of UserHelper, UserPresenter and OrderPresenter
    - moved signature to UserDecorator
    - updated user_bar layout partial

    got rid of RelationPresenter and RelationsHelper
    - extracted PolicyPresenter
    - moved the rest into RelationDecorator and RelationsDecorator
      (select_collection)
    - ClientAuth now decorates canteen_relations and current_relation
    - updated views
    - RelationPresenter spec changed to RelationDecorator and simplified

    removed course from CoursePresenter method names
    renamed TransactionPresenter to TransactionKindPresenter
    added TransactionDecorator (translates kind)
    updated transaction history view

    got rid of ChainsHelper, MealsHelper, MenuHelper, OrdersHelper,
      ApplicationHelper
    - added ChainDecorator, ChainsDecorator
    - added association decorations
    - updated views
    renamed SexDecorator to SexPresenter (nothing to decorate)

    got rid of DatesHelper
    - moved date_from_hash to MenuController
    - moved the rest to MultiparamAttributes model concern
    - changed dates_helper_spec to multiparam_attributes_spec

  = 4h

=== Tue, 16.12. ===

- prace - alto
  - 5.45-6.15 - promysleni prihlasovani, projiti SessionsControlleru a login
    testu

  = 0h30

=== Wed, 17.12. ===

- prace - alto
  - 2-4
    moved RegistrationContext to app/contexts
    extracted common functionality to SubdomainContext (will be subclassed by
      LoginContext)
    subdomain 'svetozor' is now taken as ovocenka
    simplified login specs
    upgraded rails to 4.2.0.rc3
    - no longer need to use sass-rails beta
    - simple_form 3.1.0 finaly released

    tested happy path of current profile editation

    changed registrations/edit view to haml
    removed label options - localized in locales
    added autocomplete: 'off' to form - avoids prefilling of password in FF

    - snaha o otestovani smazani profilu (javascript)

  - 6-7
    tested account deletion (uses js confirm)
    - added capybara-webkit gem, set webkit as default js driver
    - added spec/support/share_db_connection, otherwise js specs (server running
      in separate thread) don't work
    moved consumer/profile_spec to auth/profile/edit_spec

  = 3h

=== Fri, 19.12. ===

- prace - alto
  - 3-4
    added update_resource and account_update_params methods which will need to be
      overriden in RegistrationsController, added notes
    - update action examined, it won't need to be overriden completely

    added client fields to profile edit page
    added more notes to RegistrationsController#update_resource override

  = 1h

=== Sat, 20.12. ===

- prace - alto
  - 12.30-2
    - dalsi rozmysleni validace v editaci profilu a administraci klienta
    - problemy s klientskymi servicy

  - 3-5
    Client's firstname, surname and email is now validated by default
    - validation is skipped only in :administration context
    - tested
    split client_spec into client/base_spec and client/relations_spec

    simplified Admin::ClientsController and client services
    - services no longer find client or employer - they're given records
    - services no longer save client - controller does that
      - no need to validate twice
      - simpler to pass validation context
    - removed Client::Update service since it's trivial now
    - moved BuildUser.for_client to Client::Create.user_for_client
    - tested Client::Delete service
    - removed ClientsController spec in favor of feature spec
      - tested employer setting in feature spec
    - persisting of user with client now tested in client validatino spec
      since services no longer persist records and this is implemented using
      validate: true on the association
    User's password confirmation is validated on every context

    Admin::ClientsController now uses administration validation context when
      creating and updating clients
    - solves problem with validation of email, firstname and surname in profile
      editation - removed related notes

    contextual validation now works for profile editation
    - overrided User.update_with_password - takes validation context
    - supplied context to resource.update_with_password in
      RegistrationsController#update_resource
    removed card_id field from profile editation
    permitted daily_menu param in RegistrationsController

    fixed validation error on password in bakare context

    upgraded rails to 4.2.0
    - fixed specs

    removed unused BasePresenter

  = 3h30

=== Sun, 21.12. ===

- prace - alto
  - 2.15-4.15
    - prechod na bootstrap-sass, snaha o vyreseni vzhledu checkboxu

  = 2h
