select parent.OBJECT_ID, parent.NAME, parent.ALIAS, parent.STEREOTYPE, parent.NOTE, parent.TPOS, parent.EA_GUID, parent.OBJECT_TYPE, parent.PARENTID, parent.PACKAGE_ID, parent.BACKCOLOR, parent.PDATA1, parent.CLASSIFIER, parent.STATUS, parent.Version, (case when parent.object_type = 'Package' then 1 else 2 end), parent.CREATEDDATE, parent.MODIFIEDDATE, parent.AUTHOR
from T_OBJECT parent
where (
  parent.EA_GUID in (
    select container.EA_GUID from T_PACKAGE container where exists (
      select 1 from T_OBJECT contained where (
        contained.PARENTID is null or contained.PARENTID = ?
      ) and contained.STEREOTYPE = ? and contained.PACKAGE_ID = container.PACKAGE_ID
    )
  )
) and exists (select 1 from T_OBJECT child where child.STEREOTYPE = ? and child.PARENTID = parent.OBJECT_ID)
--bind(0,car,car) --micros(3,296)
