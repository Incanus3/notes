/usr/bin/gitlab-ctl (calls)
-> /opt/gitlab/bin/gitlab-ctl (unsets some env vars anc calls v)
-> /opt/gitlab/embedded/bin/omnibus-ctl gitlab '/opt/gitlab/embedded/service/omnibus-ctl*' "$@"
- this is a ruby script called through /opt/gitlab/embedded/bin/ruby
- it set's up rubygems and calls
load Gem.(activate_)bin_path("omnibus-ctl", "omnibus-ctl", version)
-> /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/omnibus-ctl-0.6.0/bin/omnibus-ctl
- this requires the omnibus-ctl gem (/opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb),
  instantiates Omnibus::Ctl with 0th arg, calls .load_files on it with 1st arg and
  then calls .run on it with rest of the args
-> Omnibus::Ctl.run
# this is what gitlab-ctl reconfigure calls from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/omnibus-ctl-0.6.0/lib/omnibus-ctl.rb
/opt/gitlab/embedded/bin/chef-client -z -c /opt/gitlab/embedded/cookbooks/solo.rb -j /opt/gitlab/embedded/cookbooks/dna.json
# -z, --local-mode                 Point chef-client at local repository
# -c, --config CONFIG              The configuration file to use
# -j JSON_ATTRIBS,                 Load attributes from a JSON file or URL

- defaultne se pousti recipe[gitlab::default]
- ktery nastavi
  node.default['gitlab']['bootstrap']['enable'] = false if File.exist?("/var/opt/gitlab/bootstrapped")
  a pak vola:
  recipe[gitlab::config]
  recipe[gitlab::web-server]
  recipe[gitlab::users]
  recipe[gitlab::gitlab-shell]
  recipe[gitlab::gitlab-rails]
  recipe[gitlab::selinux]
  recipe[gitlab::add_trusted_certs]
  recipe[package::runit_systemd]
  recipe[postgresql::bin]
  recipe[redis::enable]
  recipe[redis::enable]
  recipe[gitaly::enable]
  recipe[gitaly::enable]
  recipe[praefect::disable]
  recipe[postgresql::user]
  recipe[postgresql::enable]
  recipe[postgresql::enable]
  recipe[gitlab::database_migrations]
  recipe[gitlab::logrotate_folders_and_configs]
  recipe[gitlab::unicorn]
  recipe[gitlab::puma_disable]
  recipe[gitlab::sidekiq]
  recipe[gitlab::gitlab-workhorse]
  recipe[gitlab::mailroom_disable]
  recipe[gitlab::nginx]
  recipe[nginx::enable]
  recipe[gitlab::remote-syslog_disable]
  recipe[gitlab::logrotate]
  recipe[gitlab::gitlab-pages]
  recipe[gitlab::storage-check_disable]
  recipe[registry::enable]
  recipe[mattermost::disable]
  recipe[monitoring::user]
  recipe[monitoring::node-exporter]
  recipe[monitoring::gitlab-exporter]
  recipe[monitoring::redis-exporter]
  recipe[monitoring::prometheus]
  recipe[monitoring::alertmanager]
  recipe[monitoring::postgres-exporter]
  recipe[monitoring::grafana]
- pro pregenerovani nginx configu lze pridat parametr -o 'recipe[gitlab::config],recipe[gitlab::nginx]'
- pokud ale nechceme, aby se pokouselo spustit embedded nginx, je jeste treba nastavit
  bootstrap['enable'] = false
