=== soucet ===

2 + 4 + 2.5 + 2 + 4.5 + 3 + 3 + 1 + 8 + 2 + 1.5 + 3 + 6.5 + 6.5 + 6.5 + 5 = 61

=== Sun, 2.11. ===

- prace - alto
  - 2h
    - studium metaclassu a decoratoru - promysleni generatoru rout
    - pokusy se sandmanem

=== Mon, 3.11. ===

- prace - alto
  - 10-2
    - vytvoreni kostry pro python-datastore

  = 4h

=== Tue, 4.11. ===

- prace - alto
  - 2-4.30
    extracted getting clients from database to Clients model
    - handlers should never touch database directly, that's models' responsibility
    extracted common model behavior to BaseModel
    extracted common crud handler behavior to ResourceHandler and ResourcesHandler

    scatched basic BaseModel functionality and design
    - added interface definition and notes

    added basic test structure
    - added tests directory
    - added TestCase
      - provides get_app() for tornado.testing.AsyncHTTPTestCase
      - provides get_json(path) for subclasses
        - fetches response for path and decodes it from json
        - only get method and no params for now
    - added ClientsTest
      - subclasses TestCase
      - calls inherited get_json('/clients')
      - prints and validates response

    TestCase.get_json() now supports additional kwargs
      for http request (mainly method) but params must still be encoded in path

    TestCase.fetch() and .get_json() now support params dict

  = 2h30

=== Wed, 5.11. ===

- prace - alto
  - 1.30-2.30
    implemented and tested ResourceHandler#get(id)
    - implements show action, calls model.find(id)
    - implemented BaseModel.find(id)
    - added Clients.primary_key
    - BaseHandler#render(result) now handles both ResultProxy and RowProxy
    - TestCase#get_json now handles empty response

  - 3.45-4.45
    - scatched test for clients#create
    - started defining ClientFactory (using factory-boy), generating random data
      (using fake-factory)

  = 2h

=== Thu, 6.11. ===

- prace - alto
  - 7-8.30, 9.15-12.15
    implemented and tested ResourcesHandler#post()
    - handles create action
    - implemented BaseModel.create() - inserts and then finds by id
    - testing both record creation and response
    BaseHandler provides #request_body() decoded from json
    BaseModel.find() returns dict
    BaseModel.all() returns list of dicts
    - updated BaseHandler#render()
    added BaseFactory
    - uses factory-boy and faker
    - overrides create() - calls model.create()
    - overrides build() - only returns attributes dict
    added ClientFactory
    - used in ClientsTest
    TestCase provides #post_json() - encodes body in json
    - used in ClientsTest#test_create

    implemented and tested ResourceHandler#delete()
    - implements destroy action
    - finds and renders record, then deletes it
    - implemented BaseModel.delete(id) and .delete_all()
    simplified BaseModel.all()
    BaseModel.find(id) now returns None if nonexistent (raised error)
    extended ClientsTest
    - deletes all clients before each test
    - test_index creates clients using ClientFactory.create_batch
    added TestCase#delete_json() - like get_json, but uses DELETE method

    implemented and tested ResourceHandler#put(id)
    - handles update action
    - updates record and renders it
    - implemented BaseModel#update(id, **attributes)
    - added TestCase#put_json

    ResourcesHandler#get (index) now filters records if params given
    - implemented BaseModel.where(**conditions)
    - added BaseHandler#params()
    - tested

  = 4h30

=== Fri, 7.11. ===

- prace - alto
  - 2-5
    added bin/conttest
    - modified continual testing script based on tdaemon
    - added support for running tornado tests
    updated readme

    simplified clients_test
    bin/conttest now ignores vim temp files

    added model, handlers and routes for employers

    added bin/seed_db script
    - creates clients with employers for now
    - added EmployerFactory
    - ClientFactory creates employer for each client
    models/connection uses alto_test db if globals.env is 'test'
    - set in tests/test_case
    show action doesn't break if not found (returns empty response for now)

    updated info page

  = 3h

=== Set, 8.11. ===

- prace - alto
  - 2.45-4.15
    - projiti kodu tornada, zjisteni, jak nejlepe zdekodovat vsechny parametry
      requestu (RequestHandler umi akorat dekodovat jeden podle jmena)

    added model and handlers for canteens
    - added CanteenFactory, extended bin/seed_db
    BaseHandler#params now returns list of values if name appears repeatedly
    added index and show tests for employers and canteens - just to be sure they're
      wired up properly

    added model, handlers and routes for chains
    - added ChainFactory, extended bin/seed_db
    BaseHandler sets charset to utf-8 in Content-Type header
    BaseHandler#write doesn't encode utf chars as escape sequences

    updated info page

  - 5.30-6.30
    implemented and tested GET /chains/:id/canteens
    - added ChainCanteensHandler and route
    - added Chains.add_canteen(chain_id, canteen_id)
    - added Chains.canteens_of(chain_id)
    renamed handlers/all to handlers/resources
    updated bin/seed_db

  - 8.30-9
    implemented and tested GET /canteens/:id/chains
    - added CanteenChainsHandler and route
    - moved Chains.add_canteen() to ChainCanteenRelations.create()
    - moved Chains.canteens_of(chain_id) to ChainCanteenRelations
    - added ChainCanteenRelations.chains_of(canteen_id) and .delete_all()
    - added CanteensTest#test_canteen_chains()
    - deleting all canteens, chains and relations in tests

    updated info page

  = 3h

=== Sun, 9.11. ===

- prace - alto
  - 3.30-4.30
    simplified ChainCanteenRelations.canteens_of() and .chains_of()
    - added BaseModel.with_ids(ids)

    simplified ChainCanteenRelations.canteens_of() and chains_of() even more
    - added and inherited from JoinBase class
    - moved .create() and .delete_all() there
      - .create() now takes keyword arguments for columns (as does BaseModel)
    - added JoinBase._values_for(result_column, where_column, value)
      - used in .canteens_of() and .chains_of()
    - updated tests

    reformatted
    - fixed vim indentation to braces

  = 1h

=== Wed, 12.11. ===

- prace - alto
  - 3h - schuzka
  - 5h - studium pythonu

  = 8h

=== Tue, 18.11. ===

- prace - alto
  - 3-4
    updated gems
    moved pry to development, test group so that pry is used for rails console in
      test env too
    other minor changes and cleanup

    uncommented registration link in application layout
    updated registrations/new view to haml and new simple_form and bootstrap helpers

  - 7.15-8.15
    - rozmyšlení customizace registrace, sepsání toho, co budu potřebovat vědet
      od Alta

    prepared to override registrations#create
    cleaned up .gitignore

    scatched registration feature spec

    tested current registration functionality
    - user creation, confirmation email, log in

  = 2h

=== Wed, 19.11. ===

- prace - alto
  - 12.15-1.45
    - projiti a okomentovani kodu Devise::RegistrationsController#create
    - rozmysleni pretizeni build_resource
    - pridani klientskych poli do formulare
    - reseni s Evzou

  = 1h30

=== Thu, 20.11. ===

- prace - alto
  - 4.30-5.30
    - testování optionů validate a autosave u asociací - user-client
    - hraní s přetíženým RegistrationsControllerem

  - 11.45-1.45
    RegistrationController now creates client along with user
    - overrided build_resource
    - added nested fields for client
    - tested
    added JSON serialized personal and address attributes to Client
    - added migration
    User now validates Client upon save
    Client no longer validates presence of client_id
    - disabled in test

    fixed duplicate error on client.user

    updated db/migrate subrepo

    non-serialized client fields keep their value and show validation errors if
      invalid

  = 3h

=== Fri, 21.11. ===

- prace - alto
  - 2.30-7.30
    serialized attributes are now wrapped in OpenStructs so that nested fields_for
      can be prefilled from them
    - added OpenStructSerialization model concern
    - included into Client and used for personal and address attributes

    validation errors are now correctly rendering for serialized attributes
    - attributes are now represented as objects providing their own validations
    - added ObjectSerialization model concern and NestedAttributes class
    - included into Client
    - added Personal and Address classes subclassing NestedAttributes and defining
      validations
    - used serialize_as_object for personal and address

    instead of wrapping serialized attributes after initialization
      ObjectSerialization and OpenStructSerialization override attribute writes and
      attributes are wrapped on each write

  - 11-12.30
    from ObjectSerialization extracted ErrorMerging with #merge_errors_from
    - errors are only added once
    - used in Client#validate_user
    added fields for serialized attributes to client administration
    added missing keys to permitted client params
    disabled bullet
    fixed seeds and specs

    extracted ErrorMerging.validate_associated
    used in Client instead of validate_user

    extended ErrorMerging.validate_associated
    - message is now customizable
    - main error (<attribute> is invalid) is now optional
    used validate_associated in ObjectSerialization
    added validation errors summary to registration form

  = 6h30

=== Sat, 22.11. ===

- prace - alto
  - 11.30-2
    reformatted Client

    validation of client's personal details and address is now contextual
    - sex, birth_date and all address fields are now validated only on :bakare
    - ErrorMerging.validate_associated now passes validation_context to
      associated.valid?
    - tested
      - extracted validation tests from clients_spec
      - added tests for contextual validation
      - added client factories and traits
    firstname, surname and email are now required for Client

    added email format validation to User and Client
    - added activevalidators gem and initializer

  - 2-2.45
    - zkoumani moznosti nastaveni domeny requestu v testu

  - 3.15-6
    tested hostname override in feature specs

    enclosed routes, controllers and views in namespaces
    - paths are now prefixed with /admin or /consumer
    - controllers are enclosed in Admin or Consumer modules
    - controller and view files are moved to appropriate subdirs

    changed devise prefix from accounts to auth
    used scope for custom auth routes (sign in by card)

  = 6h30

=== Sun, 23.11. ===

- prace - alto
  - 2.45-3.15
    - adding notes for contextual registration form and actions
    - feature request to devise for save_resource extension point
      https://github.com/plataformatec/devise/issues/3336

  - 4.30-9.30
    - making registration fields conditional

  - 11.30-12.30
    overrided RegistratoinsController#create
    - added validation context to resource.save
    - added RegistrationContext model that encapsulates business logic about
      required and optinal client fields depending on subdomain
    - added decorator that conditionally renders input field for (user's) client
      form
    - added context helper method to pass info about registration fileds to views
    - used in views
    - added translations
    - partly tested field rendering
    added Client's missing personal attributes
    added daily_menu boolean column

    upgraded rails to 4.2.0.beta4
    - association validation doesn't pass validation context to association.valid?
    - fixes contextual validation errors in registration form
    - fixed forms
      - extended by ActiveModel::Naming
      - delegated has_attribute?
    ModelExtensions.alias_multiparam_attribute doesn't work anymore
    - disabled now, will need to fix rendering of aliased date fields later
    - probably fixed meal.date validation - added to field to feature spec
    added test for Meal's wrapped course attribute
    filtered out gems from backtrace

  = 6h30

=== Mon, 24.11. ===

- prace - alto
  - 1.30-2.30, 4-7
    fixed attribute aliasing
    - ModelExtensions renamed to AttributeAliasing and changed to model concern
    - overrided has_attribute?
    - fixed aliasing for associations
    - aliasing no longer works for abstract models (i.e. Company) since columns_hash
      needs table_name to be set
    fixed seeds - Client firstname and surname are now required
    added CapybaraHelpers::DateInput#select_date
    - used in admin/meals_spec

    properly tested conditional rendering of registration fields
    - extracted FieldMatchers and SubdomainOverrides support modules

  - 9-10
    clint is now found by card_id upon registration
    - added autosave to user's client
    - tested happy path

  = 5h
