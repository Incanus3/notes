=== soucet ===

3 + 3 + 4 + 5.5 + 3.5 + 5 + 5.5 + 4.5 + 4.5 + 0.5 = 39

=== Tue, 1.7. ===

- prace - alto
  - 3.30-5
    replaced MealsController spec with feature spec
    - 3x shorter, more readable, doesn't care about parameters, assigns and
      templates, only about real behavior
    - added MealPresenter with #translated_course
    - added label to canteen in meal form
    - added row attributes to meals table
    - added flash notice to meals#create
    fixed ClientsController spec after changing params

  - 11.30-1
    tested actual record creation/update in meals administration spec
    - Meal - added course and meal_number scopes, find_meal method
    - MealPresenter - added equality predicate (matches meal or presenter)

  = 3h

=== Wed, 2.7. ===

- prace - alto
  - 12-2.30
    replaced UsersController spec by feature spec
    - added row attributes to users table

    removed decent exposure from UsersController
    - gain in brevity doesn't outweight reduced readability caused by
      indirection
    spotted problem with confirmation emails upon user update
    - added comments to feature spec

    added unconfirmed email and active flag to users#show
    users administration spec tests unconfirmed email

  - 7.30-8
    updated clients#edit views - fixed markup ids
    updated login by card form to use simple_form
    fixed create user with client spec
    fixed terminal registration helper

  = 3h

=== Fri, 4.7. ===

- prace - alto
  - 7-8
    moved feature specs to subdirs

    removed CanteensController spec in favor of canteen feature specs
    removed decent_exposure from CanteensController
    - succintness doesn't outweigh readability damage caused by indirection
    - updated views
    extracted chain management from canteens/edit to partial
    simplified all show views
    - renamed object_actions shared partial to show_actions
    - added show_actions helper which renders it

    simplified canteen views
    - moved grid positioning into form partial
    - removed redundant html options from chains form
    reformatted routes

  - 10-11
    - pocatek navrhu formulare pro deadline objednavky jidelny
      - postgres typ time uklada na 8 bytu, stejne jako timestamp (s datem)
      - ukladat deadline pro kazdy chod jako integer - minuta dne
        + jeden integer pro pocet dni zpet
    - vytvoreni migrace
    - nejprve snaha o oddeleni managementu deadlinu od hlavniho formulare
      (vytvoreni partialu, nested resource deadline pod canteens)
    - nakonec uznano zbytecnym

  - 11.30-12.30, 1-2
    - vytvoreni form objektu pro jidelnu - prevadi deadliny z casoveho formatu
      (pouziteho ve formulari) na pocet minut (ulozeno v db) a zpet
      - stavi na tride DayTime (lib), ktera dela samotne prevody
    - aktualizace controlleru, aby pouzival form objekt
    - aktualizace _form partialu
    - pocatek refactoringu - treba nejprve napsat testy - funguje polovicate
    - canteens#show a menu bude take potrebovat deadline objednavek v rozumnem
      formatu - mely by pouzivat form objekt, kdyz nejde o formulare?
      - cteci logiku by slo presunout do presenteru, ale je divne, aby logika
        prevadeni deadlinu byla na 2 mistech
    - staci jeden integer pro days_before? co kdyz budu chtit deadline vecere
      rano v den odberu a deadline snidane predchozi vecer?

  = 4h

=== Sat, 5.7. ===

- prace - alto
  - 3-3.30
    - otestovani updatu deadlinu

  - 5.15-5.45
    - CanteensController pouziva CanteenForm vsude
    - zprovozneni show

  - 6.45-7.15
    simplified CanteenForm using dynamic method definition
    tested deadlines on canteen show page

  - 7.15-7.45
    refactored canteen crud feature spec
    renamed DayTime fields to match Time (hour, min, sec), added ==

  - 8.30-10.30
    extracted meals and orders from MenuController to Menu
    - updated MenuController to provide Menu instance
    - updated views to use it
    - updated MenuController spec
    updated seeds - purging all tables first in correct order
    stared updating single-portion order deadline feature spec
    - added deadlines to canteen factory

    instead of defining <course>s, <course>_order and <course>_orders for each
      course, Menu now defines only <course>_menu which returns instance of
      CourseMenu, which provides the meals, order (single) and orders (multiple)
    moved disabled and expiration methods from MenuController to Menu
    updated views to pass only course menu to partials
    updated partials to get info from course menu
    added translations for pluralized courses

  - 11.15-11.30
    extracted course-level stuff from Menu to CourseMenu
    - CourseMenu is given day_meals, day_orders, client, date and course and
      computes the course deadline, meals, order (single) and orders (multiple)

  - 11.30-12.30
    CourseMenu#disabled now uses canteen deadlines
    - added CanteenForm.deadline_for(date, course)
    instead of passing all fields from Menu to CourseMenu, CourseMenu holds
      reference to Menu and asks it

  - 1-1.15
    used delegate with prefix to get meals and orders from Menu to CourseMenu
    fixed visibility for delegates
    used Date#in_time_zone instead of deprecated #to_time_in_current_zone

  = 5h30

=== Sun, 6.7 ===

- prace - alto
  - 2.45-3.15
    updated orderd deadline feature specs

  - 3.30-4.30
    updated MenuController spec after moving functionality to CourseMenu
    updated meal factory date to default to 2 days forward to ensure orderability

  - 5.30-7.30
    extracted menu related tests from MenuController spec to Menu spec

    deadline for each course is now stored as number
      of minutes to midnight after meal
    - updated CanteensController, CanteenForm and DayTime
    - updated views
    - updated canteens crud spec and canteen factory

    refactored CanteenForm
    updated canteens#show view
    updated canteens crud spec

  = 3h30

=== Mon, 7.7. ===

- prace - alto
  - 2-4
    fixed markup for canteen form - showing time inputs inline
    - added bootstrap3_horizontal_time wrapper to simple_form_bootstrap initializer
    - added wrapper mapping for time to horizontal_form_for helper
    - removed headings, added labels for courses and hints for fields
    - fixed canteens crud spec

  - 5.45-7.45
    refactored CanteenForm
    - extracted Deadline for converting btw deadline representations
    - simplified the rest

    simplified single-portion menu form
    - added possibly disabled fieldset, removed disabled from inputs
    - updated helper for primary button to pass additional options
    - added helper for danger button
    - used both in form
    - simplified spec - disabled flag needs to be checked only on fieldset

  - 10.30-11
    simplified single-portion menu form
    - moved fieldset from helpers to simple_form builder

  - 1-1.30
    removed unneeded block param from desc_list
    structured canteen show view (deadline headlines)

  = 5h

=== Tue, 8.7. ===

- prace - alto
  - 2.45-3.30
    no longer monkeypatching SimpleForm::FormBuilder
    - inherited as CustomFormBuilder, autoloaded from lib
    - added custom_form_for, inline_ and horizontal_form_for call this
    - moved these to BootstrapHelper
    - no longer need to restart rails after changes to form builder
    removed unused bootstrap_forms monkeypatches
    fixed canteens crud spec after structuring show view, added ids to view

    fixed reordering of meals
    - create action is used only if order is a new record (not yet saved), when it's
      saved but empty, we need to reuse it
    - setting portions_ordered to 1 in update
    - added spec

  - 5-5.45
    updated gems
    - updated rails to 4.0.8
    - fixed datepicker require in application.js and .css after jquery-ui-rails
      upgrade
    - added form-control class to inputs in bootstrap initializer (formerly done by
      monkeypatches of input classes)
    - used simple_form 3.1.0.rc2 instead of github version

  - 6-6.30
    updated info page
    reannotated models

    - zaktualizovana verze na serveru - problem se submoduly

    added capistrano task to pull git submodules

  - 6.30-7
    zaktualizovano rvm a ruby na serveru a lokalne

  - 7-7.30
    upgraded to rails 4.1.4
    - no longer causes stack overflow
    - fixed CreateClientForm#forwareded_methods - attribute_names and reflections
      are now class methods on ActiveRecord::Base

  - 7.30-8
    - added bullet
    - started optimizing reported queries

  - 8-10
    - stack overflow still happends, it just didn't appear before
    - tracing function calls using TracePoint, isolating the log

  = 5h30

=== Wed, 9.7. ===

- prace - alto
  - 8-10.30 - pokracovani v debugu stack level too deep po upgradu na 4.1
  - 11-1 - doreseni problemu se stack overflow, problem je v meta_request,
    ktery nutne nepotrebujeme

    removed meta_request since it caused stack overflow in rails 4.1
    added bullet to detect unoptimal queries
    - enabled in development, disabled in tests - reported some false alarms on
      factory-created records
    - adjusted several eager loads
    fixed bug in clients#edit - companies to choose from weren't set

  = 4h30

=== Thu, 10.7. ===

- prace - alto
  - 5.30-7.30
    added filtering to index_route generator

    implemented Locks.unlock, tested
    fixed /locks and /variables index routes by adding ColumnNamesMapping to Locks
    renamed semafory.locked_by to locker
    - updated migrations submodule, migrated schema

    locker removed from index_route options

  - 10.30-1
    added more tests for Locks.lock
    - added timecop gem
    - tested lock times and relocks

    simplified Locks.lock
    - ModelBase - extracted private low-level _create and _update methods which
      don't provide error handling

    simplified Locks.unlock
    - ModelBase - extracted private low-level _delete and _delete! - no error
      handling
    - restructured tests for it

    Locks.invalid? now covers both old locks and locks too far to the future

    removed unneeded lock_ds_for, simplified lock_for

    extracted Keyholes model from Locks
    updated /ahoj route

    refactored Locks.lock
    - extracted common create/update values
    - extracted loggin of refused relock

  = 4h30

=== Fri, 11.7. ===

- prace - alto
  - 1.45-2.15 - drobne upravy locku
    removed /locks/get, create_route /locks and delete_route /locks
    - removed Locks.get
    changed /locks/lock and /locks/unlock to post
    - updated specs

    updated info page

  = 0h30
